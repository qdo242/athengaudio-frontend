<div class="product-detail-page">
  <div class="container">
    <!-- Breadcrumb -->
    <div class="breadcrumb">
      <a routerLink="/">Trang ch·ªß</a>
      <span class="separator">/</span>
      <a routerLink="/products">S·∫£n ph·∫©m</a>
      <span class="separator">/</span>
      <span class="current" *ngIf="product">{{ product.name }}</span>
    </div>

    @if (product) {
      <div class="product-detail">
        <!-- Product Images & Info -->
        <div class="product-main">
          <!-- Product Images -->
          <div class="product-images">
            <div class="main-image">
              <img [src]="selectedImage" [alt]="product.name" class="product-image">
              @if (product.originalPrice) {
                <div class="discount-badge">
                  -{{ getDiscount() }}%
                </div>
              }
              @if (!product.inStock) {
                <div class="out-of-stock-overlay">
                  <span>H·∫øt H√†ng</span>
                </div>
              }
            </div>
            
            <div class="image-thumbnails">
              <div 
                class="thumbnail" 
                [class.active]="selectedImage === product.image"
                (click)="changeImage(product.image)"
              >
                <img [src]="product.image" [alt]="product.name">
              </div>
              <!-- C√≥ th·ªÉ th√™m nhi·ªÅu ·∫£nh kh√°c ·ªü ƒë√¢y -->
            </div>
          </div>

          <!-- Product Info -->
          <div class="product-info">
            <div class="product-header">
              <h1 class="product-title">{{ product.name }}</h1>
              <div class="product-meta">
                <span class="product-brand">Th∆∞∆°ng hi·ªáu: {{ product.brand }}</span>
                <span class="product-sku">M√£ SP: #{{ product.id }}</span>
              </div>
            </div>

            <!-- Rating -->
            <div class="product-rating">
              <div class="rating-stars">
                <span class="stars">{{ getStarRating(product.rating) }}</span>
                <span class="rating-value">{{ product.rating }}/5</span>
              </div>
              <span class="reviews-count">({{ product.reviews }} ƒë√°nh gi√°)</span>
            </div>

            <!-- Price -->
            <div class="product-price">
              <span class="current-price">{{ product.price | number }}‚Ç´</span>
              @if (product.originalPrice) {
                <span class="original-price">{{ product.originalPrice | number }}‚Ç´</span>
              }
            </div>

            <!-- Short Description -->
            <div class="product-short-desc">
              <p>{{ product.description }}</p>
            </div>

            <!-- Features -->
            <div class="product-features">
              <h3>ƒê·∫∑c ƒëi·ªÉm n·ªïi b·∫≠t:</h3>
              <ul class="features-list">
                @for (feature of product.features; track feature) {
                  <li class="feature-item">‚úì {{ feature }}</li>
                }
              </ul>
            </div>

            <!-- Quantity & Actions -->
            <div class="product-actions">
              <div class="quantity-selector">
                <label class="quantity-label">S·ªë l∆∞·ª£ng:</label>
                <div class="quantity-controls">
                  <button 
                    class="quantity-btn" 
                    (click)="decreaseQuantity()"
                    [disabled]="quantity <= 1"
                  >
                    ‚àí
                  </button>
                  <span class="quantity-display">{{ quantity }}</span>
                  <button 
                    class="quantity-btn" 
                    (click)="increaseQuantity()"
                  >
                    +
                  </button>
                </div>
              </div>

              <div class="action-buttons">
                <button 
                  class="btn btn-secondary add-to-cart-btn"
                  (click)="addToCart()"
                  [disabled]="!product.inStock"
                >
                  üõí Th√™m V√†o Gi·ªè
                </button>
                <button 
                  class="btn btn-primary buy-now-btn"
                  (click)="buyNow()"
                  [disabled]="!product.inStock"
                >
                  Mua Ngay
                </button>
              </div>
            </div>

            <!-- Product Meta -->
            <div class="product-meta-info">
              <div class="meta-item">
                <span class="meta-icon">üöö</span>
                <div class="meta-text">
                  <strong>Giao h√†ng mi·ªÖn ph√≠</strong>
                  <span>Cho ƒë∆°n h√†ng t·ª´ 500K</span>
                </div>
              </div>
              <div class="meta-item">
                <span class="meta-icon">üîí</span>
                <div class="meta-text">
                  <strong>B·∫£o h√†nh 2 nƒÉm</strong>
                  <span>Ch√≠nh h√£ng to√†n qu·ªëc</span>
                </div>
              </div>
              <div class="meta-item">
                <span class="meta-icon">üîÑ</span>
                <div class="meta-text">
                  <strong>ƒê·ªïi tr·∫£ 30 ng√†y</strong>
                  <span>Ho√†n ti·ªÅn 100%</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Product Tabs -->
        <div class="product-tabs">
          <div class="tab-headers">
            <button 
              class="tab-header" 
              [class.active]="activeTab === 'description'"
              (click)="setActiveTab('description')"
            >
              M√¥ T·∫£ S·∫£n Ph·∫©m
            </button>
            <button 
              class="tab-header" 
              [class.active]="activeTab === 'specs'"
              (click)="setActiveTab('specs')"
            >
              Th√¥ng S·ªë K·ªπ Thu·∫≠t
            </button>
            <button 
              class="tab-header" 
              [class.active]="activeTab === 'reviews'"
              (click)="setActiveTab('reviews')"
            >
              ƒê√°nh Gi√° ({{ product.reviews }})
            </button>
          </div>

          <div class="tab-content">
            @if (activeTab === 'description') {
              <div class="tab-pane">
                <h3>Chi Ti·∫øt S·∫£n Ph·∫©m</h3>
                <p>{{ product.description }}</p>
                <div class="detailed-features">
                  <h4>T√≠nh nƒÉng chi ti·∫øt:</h4>
                  <ul>
                    @for (feature of product.features; track feature) {
                      <li>{{ feature }}</li>
                    }
                  </ul>
                </div>
              </div>
            }

            @if (activeTab === 'specs') {
              <div class="tab-pane">
                <h3>Th√¥ng S·ªë K·ªπ Thu·∫≠t</h3>
                <div class="specs-table">
                  <div class="spec-row">
                    <span class="spec-label">Th∆∞∆°ng hi·ªáu</span>
                    <span class="spec-value">{{ product.brand }}</span>
                  </div>
                  <div class="spec-row">
                    <span class="spec-label">Lo·∫°i tai nghe</span>
                    <span class="spec-value">{{ product.category }}</span>
                  </div>
                  <div class="spec-row">
                    <span class="spec-label">K·∫øt n·ªëi</span>
                    <span class="spec-value">Bluetooth 5.0, Jack 3.5mm</span>
                  </div>
                  <div class="spec-row">
                    <span class="spec-label">Th·ªùi l∆∞·ª£ng pin</span>
                    <span class="spec-value">30 gi·ªù</span>
                  </div>
                  <div class="spec-row">
                    <span class="spec-label">Ch·ªëng ·ªìn</span>
                    <span class="spec-value">C√≥</span>
                  </div>
                  <div class="spec-row">
                    <span class="spec-label">Tr·ªçng l∆∞·ª£ng</span>
                    <span class="spec-value">250g</span>
                  </div>
                </div>
              </div>
            }

            @if (activeTab === 'reviews') {
              <div class="tab-pane">
                <h3>ƒê√°nh Gi√° T·ª´ Kh√°ch H√†ng</h3>
                <div class="reviews-summary">
                  <div class="overall-rating">
                    <div class="rating-score">{{ product.rating }}</div>
                    <div class="rating-stars-large">{{ getStarRating(product.rating) }}</div>
                    <div class="rating-text">{{ product.reviews }} ƒë√°nh gi√°</div>
                  </div>
                  
                  <div class="reviews-list">
                    <div class="review-item">
                      <div class="review-header">
                        <span class="reviewer-name">Nguy·ªÖn VƒÉn A</span>
                        <span class="review-rating">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</span>
                      </div>
                      <p class="review-content">
                        "S·∫£n ph·∫©m ch·∫•t l∆∞·ª£ng tuy·ªát v·ªùi, √¢m thanh s·ªëng ƒë·ªông. Giao h√†ng nhanh, ƒë√≥ng g√≥i c·∫©n th·∫≠n."
                      </p>
                      <span class="review-date">15/12/2024</span>
                    </div>
                    
                    <div class="review-item">
                      <div class="review-header">
                        <span class="reviewer-name">Tr·∫ßn Th·ªã B</span>
                        <span class="review-rating">‚òÖ‚òÖ‚òÖ‚òÖ‚òÜ</span>
                      </div>
                      <p class="review-content">
                        "Tai nghe ƒë·∫πp, √¢m bass t·ªët. Pin s·ª≠ d·ª•ng ƒë∆∞·ª£c l√¢u. Nh∆∞ng h∆°i n·∫∑ng khi ƒëeo l√¢u."
                      </p>
                      <span class="review-date">10/12/2024</span>
                    </div>
                  </div>
                </div>
              </div>
            }
          </div>
        </div>

        <!-- Related Products -->
        @if (relatedProducts.length > 0) {
          <div class="related-products">
            <h2 class="section-title">S·∫£n Ph·∫©m Li√™n Quan</h2>
            <div class="related-products-grid">
              @for (relatedProduct of relatedProducts; track relatedProduct.id) {
                <div class="related-product-card" [routerLink]="['/products', relatedProduct.id]">
                  <div class="product-image">
                    <img [src]="relatedProduct.image" [alt]="relatedProduct.name">
                  </div>
                  <div class="product-info">
                    <h3 class="product-name">{{ relatedProduct.name }}</h3>
                    <p class="product-brand">{{ relatedProduct.brand }}</p>
                    <div class="product-price">
                      <span class="current-price">{{ relatedProduct.price | number }}‚Ç´</span>
                      @if (relatedProduct.originalPrice) {
                        <span class="original-price">{{ relatedProduct.originalPrice | number }}‚Ç´</span>
                      }
                    </div>
                  </div>
                </div>
              }
            </div>
          </div>
        }
      </div>
    } @else {
      <div class="loading-state">
        <div class="loading-spinner"></div>
        <p>ƒêang t·∫£i th√¥ng tin s·∫£n ph·∫©m...</p>
      </div>
    }
  </div>
</div>