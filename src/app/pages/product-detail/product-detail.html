<div class="product-detail-page">
  <div class="container">
    <!-- Breadcrumb -->
    <div class="breadcrumb">
      <a routerLink="/">Trang ch·ªß</a>
      <span class="separator">/</span>
      <a routerLink="/products">S·∫£n ph·∫©m</a>
      <span class="separator">/</span>
      <span class="current" *ngIf="product">{{ product.name }}</span>
    </div>

    <div *ngIf="isLoading" class="loading-state">
      <div class="loading-spinner"></div>
      <p>ƒêang t·∫£i th√¥ng tin s·∫£n ph·∫©m...</p>
    </div>

    <div *ngIf="!isLoading && product" class="product-detail">
      <!-- Product Images & Info -->
      <div class="product-main">
        <!-- Product Images -->
        <div class="product-images">
          <div class="main-image">
            <img [src]="selectedImage" [alt]="product.name" class="product-image">
            <div class="image-badges">
              <div *ngIf="product.originalPrice" class="discount-badge">
                -{{ getDiscount() }}%
              </div>
              <div *ngIf="!product.inStock" class="out-of-stock-badge">
                H·∫øt H√†ng
              </div>
              <div *ngIf="product.inStock && product.stock < 10" class="low-stock-badge">
                S·∫Øp h·∫øt h√†ng
              </div>
            </div>
          </div>
          
          <div class="image-thumbnails" *ngIf="product.images && product.images.length > 1">
            <div 
              *ngFor="let image of product.images" 
              class="thumbnail" 
              [class.active]="selectedImage === image"
              (click)="changeImage(image)"
            >
              <img [src]="image" [alt]="product.name">
            </div>
          </div>
        </div>

        <!-- Product Info -->
        <div class="product-info">
          <div class="product-header">
            <h1 class="product-title">{{ product.name }}</h1>
            <div class="product-meta">
              <span class="product-brand">Th∆∞∆°ng hi·ªáu: {{ product.brand }}</span>
              <span class="product-sku">M√£ SP: #{{ product.id }}</span>
              <span class="product-stock" [class.in-stock]="product.inStock" [class.out-of-stock]="!product.inStock">
                {{ product.inStock ? 'C√≤n h√†ng' : 'H·∫øt h√†ng' }}
              </span>
            </div>
          </div>

          <!-- Rating -->
          <div class="product-rating">
            <div class="rating-stars">
              <span class="stars">{{ getStarRating(product.rating || 0) }}</span>
              <span class="rating-value">{{ product.rating }}/5</span>
            </div>
            <span class="reviews-count">({{ product.reviews }} ƒë√°nh gi√°)</span>
            <a href="#" class="write-review">Vi·∫øt ƒë√°nh gi√°</a>
          </div>

          <!-- Price -->
          <div class="product-price">
            <span class="current-price">{{ product.price | number }}‚Ç´</span>
            <span *ngIf="product.originalPrice" class="original-price">
              {{ product.originalPrice | number }}‚Ç´
            </span>
            <span *ngIf="product.originalPrice" class="discount-amount">
              Ti·∫øt ki·ªám: {{ (product.originalPrice - product.price) | number }}‚Ç´
            </span>
          </div>

          <!-- Short Description -->
          <div class="product-short-desc">
            <p>{{ product.description }}</p>
          </div>

          <!-- Features -->
          <div class="product-features" *ngIf="product.features && product.features.length > 0">
            <h3>ƒê·∫∑c ƒëi·ªÉm n·ªïi b·∫≠t:</h3>
            <ul class="features-list">
              <li *ngFor="let feature of product.features" class="feature-item">
                <span class="feature-icon">‚úì</span>
                {{ feature }}
              </li>
            </ul>
          </div>

          <!-- Quantity & Actions -->
          <div class="product-actions">
            <div class="quantity-selector">
              <label class="quantity-label">S·ªë l∆∞·ª£ng:</label>
              <div class="quantity-controls">
                <button 
                  class="quantity-btn" 
                  (click)="decreaseQuantity()"
                  [disabled]="quantity <= 1"
                >
                  ‚àí
                </button>
                <span class="quantity-display">{{ quantity }}</span>
                <button 
                  class="quantity-btn" 
                  (click)="increaseQuantity()"
                  [disabled]="!product.inStock"
                >
                  +
                </button>
              </div>
              <span class="stock-info" *ngIf="product.inStock">
                {{ product.stock }} s·∫£n ph·∫©m c√≥ s·∫µn
              </span>
            </div>

            <div class="action-buttons">
              <button 
                class="btn btn-secondary add-to-cart-btn"
                (click)="addToCart()"
                [disabled]="!product.inStock"
              >
                <span class="btn-icon">üõí</span>
                Th√™m V√†o Gi·ªè
              </button>
              <button 
                class="btn btn-primary buy-now-btn"
                (click)="buyNow()"
                [disabled]="!product.inStock"
              >
                <span class="btn-icon">‚ö°</span>
                Mua Ngay
              </button>
              <button 
                class="btn btn-wishlist"
                (click)="addToWishlist()"
                [class.in-wishlist]="isInWishlist()"
                title="Th√™m v√†o y√™u th√≠ch"
              >
                <span class="btn-icon">{{ isInWishlist() ? '‚ù§Ô∏è' : 'ü§ç' }}</span>
              </button>
            </div>
          </div>

          <!-- Product Meta -->
          <div class="product-meta-info">
            <div class="meta-item">
              <span class="meta-icon">üöö</span>
              <div class="meta-text">
                <strong>Giao h√†ng mi·ªÖn ph√≠</strong>
                <span>Cho ƒë∆°n h√†ng t·ª´ 500K</span>
              </div>
            </div>
            <div class="meta-item">
              <span class="meta-icon">üîí</span>
              <div class="meta-text">
                <strong>B·∫£o h√†nh {{ product.warranty || '2 nƒÉm' }}</strong>
                <span>Ch√≠nh h√£ng to√†n qu·ªëc</span>
              </div>
            </div>
            <div class="meta-item">
              <span class="meta-icon">üîÑ</span>
              <div class="meta-text">
                <strong>ƒê·ªïi tr·∫£ 30 ng√†y</strong>
                <span>Ho√†n ti·ªÅn 100%</span>
              </div>
            </div>
            <div class="meta-item">
              <span class="meta-icon">üìû</span>
              <div class="meta-text">
                <strong>H·ªó tr·ª£ 24/7</strong>
                <span>1900 1234</span>
              </div>
            </div>
          </div>

          <!-- Admin Notice -->
          <div *ngIf="showAdminNotice()" class="admin-notice">
            <div class="admin-icon">üëë</div>
            <div class="admin-text">
              <strong>Ch·∫ø ƒë·ªô Qu·∫£n tr·ªã vi√™n</strong>
              <span>B·∫°n c√≥ th·ªÉ ch·ªânh s·ª≠a th√¥ng tin s·∫£n ph·∫©m</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Product Tabs -->
      <div class="product-tabs">
        <div class="tab-headers">
          <button 
            class="tab-header" 
            [class.active]="activeTab === 'description'"
            (click)="setActiveTab('description')"
          >
            üìñ M√¥ T·∫£ S·∫£n Ph·∫©m
          </button>
          <button 
            class="tab-header" 
            [class.active]="activeTab === 'specs'"
            (click)="setActiveTab('specs')"
          >
            ‚öôÔ∏è Th√¥ng S·ªë K·ªπ Thu·∫≠t
          </button>
          <button 
            class="tab-header" 
            [class.active]="activeTab === 'reviews'"
            (click)="setActiveTab('reviews')"
          >
            ‚≠ê ƒê√°nh Gi√° ({{ product.reviews }})
          </button>
          <button 
            class="tab-header" 
            [class.active]="activeTab === 'warranty'"
            (click)="setActiveTab('warranty')"
          >
            üõ°Ô∏è B·∫£o H√†nh &amp; ƒê·ªïi Tr·∫£
          </button>
        </div>

        <div class="tab-content">
          <!-- Description Tab -->
          <div *ngIf="activeTab === 'description'" class="tab-pane">
            <div class="description-content">
              <h3>Chi Ti·∫øt S·∫£n Ph·∫©m</h3>
              <p>{{ product.description }}</p>
              
              <div *ngIf="product.features && product.features.length > 0" class="detailed-features">
                <h4>üìã T√≠nh nƒÉng chi ti·∫øt:</h4>
                <ul>
                  <li *ngFor="let feature of product.features">{{ feature }}</li>
                </ul>
              </div>

              <div class="product-benefits">
                <h4>üéØ L·ª£i √≠ch khi s·ª≠ d·ª•ng:</h4>
                <div class="benefits-grid">
                  <div class="benefit-item">
                    <span class="benefit-icon">üéµ</span>
                    <div class="benefit-text">
                      <strong>√Çm thanh s·ªëng ƒë·ªông</strong>
                      <p>Ch·∫•t l∆∞·ª£ng √¢m thanh cao c·∫•p, tr·∫£i nghi·ªám √¢m nh·∫°c ch√¢n th·ª±c</p>
                    </div>
                  </div>
                  <div class="benefit-item">
                    <span class="benefit-icon">üîã</span>
                    <div class="benefit-text">
                      <strong>Pin l√¢u d√†i</strong>
                      <p>Th·ªùi l∆∞·ª£ng pin ·∫•n t∆∞·ª£ng, s·ª≠ d·ª•ng c·∫£ ng√†y d√†i</p>
                    </div>
                  </div>
                  <div class="benefit-item">
                    <span class="benefit-icon">üéß</span>
                    <div class="benefit-text">
                      <strong>Tho·∫£i m√°i khi ƒëeo</strong>
                      <p>Thi·∫øt k·∫ø ergonomic, ƒëeo l√¢u kh√¥ng g√¢y m·ªèi</p>
                    </div>
                  </div>
                  <div class="benefit-item">
                    <span class="benefit-icon">üì±</span>
                    <div class="benefit-text">
                      <strong>K·∫øt n·ªëi ƒëa d·∫°ng</strong>
                      <p>T∆∞∆°ng th√≠ch v·ªõi nhi·ªÅu thi·∫øt b·ªã v√† h·ªá ƒëi·ªÅu h√†nh</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Specifications Tab -->
          <div *ngIf="activeTab === 'specs'" class="tab-pane">
            <h3>üìä Th√¥ng S·ªë K·ªπ Thu·∫≠t</h3>
            <div class="specs-table">
              <div class="spec-row" *ngIf="product.brand">
                <span class="spec-label">Th∆∞∆°ng hi·ªáu</span>
                <span class="spec-value">{{ product.brand }}</span>
              </div>
              <div class="spec-row" *ngIf="product.category">
                <span class="spec-label">Danh m·ª•c</span>
                <span class="spec-value">{{ product.category }}</span>
              </div>
              <div class="spec-row" *ngIf="product.type">
                <span class="spec-label">Lo·∫°i s·∫£n ph·∫©m</span>
                <span class="spec-value">{{ product.type }}</span>
              </div>
              <div class="spec-row" *ngIf="product.weight">
                <span class="spec-label">Tr·ªçng l∆∞·ª£ng</span>
                <span class="spec-value">{{ product.weight }}</span>
              </div>
              <div class="spec-row" *ngIf="product.batteryLife">
                <span class="spec-label">Th·ªùi l∆∞·ª£ng pin</span>
                <span class="spec-value">{{ product.batteryLife }}</span>
              </div>
              <div class="spec-row" *ngIf="product.connectivity">
                <span class="spec-label">K·∫øt n·ªëi</span>
                <span class="spec-value">{{ formatArray(product.connectivity) }}</span>
              </div>
              <div class="spec-row" *ngIf="product.material">
                <span class="spec-label">Ch·∫•t li·ªáu</span>
                <span class="spec-value">{{ product.material }}</span>
              </div>
              <div class="spec-row" *ngIf="hasSpec(product.noiseCancellation)">
                <span class="spec-label">Ch·ªëng ·ªìn</span>
                <span class="spec-value">{{ product.noiseCancellation ? 'C√≥' : 'Kh√¥ng' }}</span>
              </div>
              <div class="spec-row" *ngIf="hasSpec(product.waterResistant)">
                <span class="spec-label">Ch·ªëng n∆∞·ªõc</span>
                <span class="spec-value">{{ product.waterResistant ? 'C√≥' : 'Kh√¥ng' }}</span>
              </div>
              <div class="spec-row" *ngIf="product.warranty">
                <span class="spec-label">B·∫£o h√†nh</span>
                <span class="spec-value">{{ product.warranty }}</span>
              </div>
              <div class="spec-row" *ngIf="product.compatibility">
                <span class="spec-label">T∆∞∆°ng th√≠ch</span>
                <span class="spec-value">{{ formatArray(product.compatibility) }}</span>
              </div>
            </div>
          </div>

          <!-- Reviews Tab -->
          <div *ngIf="activeTab === 'reviews'" class="tab-pane">
            <div class="reviews-content">
              <div class="reviews-summary">
                <div class="overall-rating">
                  <div class="rating-score">{{ product.rating }}</div>
                  <div class="rating-stars-large">{{ getStarRating(product.rating || 0) }}</div>
                  <div class="rating-text">D·ª±a tr√™n {{ product.reviews }} ƒë√°nh gi√°</div>
                </div>
                
                <div class="rating-breakdown">
                  <div class="rating-bar">
                    <span class="rating-label">5 sao</span>
                    <div class="rating-progress">
                      <div class="progress-bar" [style.width]="'75%'"></div>
                    </div>
                    <span class="rating-count">75%</span>
                  </div>
                  <div class="rating-bar">
                    <span class="rating-label">4 sao</span>
                    <div class="rating-progress">
                      <div class="progress-bar" [style.width]="'15%'"></div>
                    </div>
                    <span class="rating-count">15%</span>
                  </div>
                  <div class="rating-bar">
                    <span class="rating-label">3 sao</span>
                    <div class="rating-progress">
                      <div class="progress-bar" [style.width]="'7%'"></div>
                    </div>
                    <span class="rating-count">7%</span>
                  </div>
                  <div class="rating-bar">
                    <span class="rating-label">2 sao</span>
                    <div class="rating-progress">
                      <div class="progress-bar" [style.width]="'2%'"></div>
                    </div>
                    <span class="rating-count">2%</span>
                  </div>
                  <div class="rating-bar">
                    <span class="rating-label">1 sao</span>
                    <div class="rating-progress">
                      <div class="progress-bar" [style.width]="'1%'"></div>
                    </div>
                    <span class="rating-count">1%</span>
                  </div>
                </div>
              </div>

              <div class="reviews-list">
                <h4>ƒê√°nh gi√° g·∫ßn ƒë√¢y</h4>
                
                <div class="review-item">
                  <div class="review-header">
                    <div class="reviewer-info">
                      <span class="reviewer-name">Nguy·ªÖn VƒÉn A</span>
                      <span class="review-verified">‚úÖ ƒê√£ x√°c th·ª±c mua h√†ng</span>
                    </div>
                    <div class="review-rating">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
                  </div>
                  <p class="review-content">
                    "S·∫£n ph·∫©m ch·∫•t l∆∞·ª£ng tuy·ªát v·ªùi, √¢m thanh s·ªëng ƒë·ªông. Giao h√†ng nhanh, ƒë√≥ng g√≥i c·∫©n th·∫≠n. 
                    Tai nghe ƒëeo r·∫•t tho·∫£i m√°i, pin s·ª≠ d·ª•ng ƒë∆∞·ª£c l√¢u. R·∫•t h√†i l√≤ng v·ªõi tr·∫£i nghi·ªám!"
                  </p>
                  <div class="review-footer">
                    <span class="review-date">15/12/2024</span>
                    <div class="review-helpful">
                      <button class="helpful-btn">üëç H·ªØu √≠ch (24)</button>
                      <button class="helpful-btn">üëé Kh√¥ng h·ªØu √≠ch (2)</button>
                    </div>
                  </div>
                </div>
                
                <div class="review-item">
                  <div class="review-header">
                    <div class="reviewer-info">
                      <span class="reviewer-name">Tr·∫ßn Th·ªã B</span>
                      <span class="review-verified">‚úÖ ƒê√£ x√°c th·ª±c mua h√†ng</span>
                    </div>
                    <div class="review-rating">‚òÖ‚òÖ‚òÖ‚òÖ‚òÜ</div>
                  </div>
                  <p class="review-content">
                    "Tai nghe ƒë·∫πp, √¢m bass t·ªët. Pin s·ª≠ d·ª•ng ƒë∆∞·ª£c l√¢u. Nh∆∞ng h∆°i n·∫∑ng khi ƒëeo l√¢u. 
                    Ch·∫•t l∆∞·ª£ng √¢m thanh overall r·∫•t t·ªët, ƒë√°ng ƒë·ªìng ti·ªÅn."
                  </p>
                  <div class="review-footer">
                    <span class="review-date">10/12/2024</span>
                    <div class="review-helpful">
                      <button class="helpful-btn">üëç H·ªØu √≠ch (18)</button>
                      <button class="helpful-btn">üëé Kh√¥ng h·ªØu √≠ch (1)</button>
                    </div>
                  </div>
                </div>

                <div class="load-more-reviews">
                  <button class="btn btn-outline">Xem th√™m ƒë√°nh gi√°</button>
                </div>
              </div>
            </div>
          </div>

          <!-- Warranty Tab -->
          <div *ngIf="activeTab === 'warranty'" class="tab-pane">
            <div class="warranty-content">
              <h3>üõ°Ô∏è Ch√≠nh S√°ch B·∫£o H√†nh & ƒê·ªïi Tr·∫£</h3>
              
              <div class="warranty-info">
                <div class="warranty-item">
                  <h4>üì¶ Ch√≠nh s√°ch b·∫£o h√†nh</h4>
                  <ul>
                    <li>B·∫£o h√†nh ch√≠nh h√£ng {{ product.warranty || '24 th√°ng' }}</li>
                    <li>B·∫£o h√†nh to√†n qu·ªëc t·∫°i c√°c trung t√¢m ·ªßy quy·ªÅn</li>
                    <li>1 ƒë·ªïi 1 trong 30 ng√†y n·∫øu c√≥ l·ªói t·ª´ nh√† s·∫£n xu·∫•t</li>
                    <li>H·ªó tr·ª£ s·ª≠a ch·ªØa trong su·ªët th·ªùi gian b·∫£o h√†nh</li>
                  </ul>
                </div>

                <div class="warranty-item">
                  <h4>üîÑ Ch√≠nh s√°ch ƒë·ªïi tr·∫£</h4>
                  <ul>
                    <li>ƒê·ªïi tr·∫£ trong 30 ng√†y n·∫øu s·∫£n ph·∫©m l·ªói k·ªπ thu·∫≠t</li>
                    <li>Ho√†n ti·ªÅn 100% trong v√≤ng 7 ng√†y n·∫øu kh√¥ng h√†i l√≤ng</li>
                    <li>Mi·ªÖn ph√≠ ƒë·ªïi tr·∫£, v·∫≠n chuy·ªÉn 2 chi·ªÅu</li>
                    <li>S·∫£n ph·∫©m ph·∫£i c√≤n nguy√™n v·∫πn, ƒë·∫ßy ƒë·ªß ph·ª• ki·ªán</li>
                  </ul>
                </div>

                <div class="warranty-item">
                  <h4>üöö Ch√≠nh s√°ch giao h√†ng</h4>
                  <ul>
                    <li>Giao h√†ng mi·ªÖn ph√≠ to√†n qu·ªëc cho ƒë∆°n t·ª´ 500.000ƒë</li>
                    <li>Giao h√†ng nhanh trong 2-4 gi·ªù t·∫°i n·ªôi th√†nh</li>
                    <li>Ki·ªÉm tra h√†ng tr∆∞·ªõc khi thanh to√°n</li>
                    <li>H·ªó tr·ª£ ƒë√≥ng g√≥i qu√† t·∫∑ng mi·ªÖn ph√≠</li>
                  </ul>
                </div>
              </div>

              <div class="support-contact">
                <h4>üìû Li√™n h·ªá h·ªó tr·ª£</h4>
                <div class="contact-info">
                  <p><strong>Hotline:</strong> 1900 1234 (Mi·ªÖn ph√≠)</p>
                  <p><strong>Email:</strong> support@athengaudio.com</p>
                  <p><strong>Gi·ªù l√†m vi·ªác:</strong> 8:00 - 22:00 h√†ng ng√†y</p>
                  <p><strong>ƒê·ªãa ch·ªâ:</strong> 123 Nguy·ªÖn VƒÉn Linh, Qu·∫≠n 7, TP.HCM</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Related Products -->
      <div *ngIf="relatedProducts.length > 0" class="related-products">
        <h2 class="section-title">S·∫£n Ph·∫©m Li√™n Quan</h2>
        <div class="related-products-grid">
          <div 
            *ngFor="let relatedProduct of relatedProducts" 
            class="related-product-card"
            [routerLink]="['/product-detail', relatedProduct.id]"
          >
            <div class="product-image">
              <img [src]="relatedProduct.image" [alt]="relatedProduct.name">
              <div class="product-badge" *ngIf="relatedProduct.originalPrice">
                -{{ ((relatedProduct.originalPrice - relatedProduct.price) / relatedProduct.originalPrice * 100) | number:'1.0-0' }}%
              </div>
            </div>
            <div class="product-info">
              <h3 class="product-name">{{ relatedProduct.name }}</h3>
              <p class="product-brand">{{ relatedProduct.brand }}</p>
              <div class="product-price">
                <span class="current-price">{{ relatedProduct.price | number }}‚Ç´</span>
                <span *ngIf="relatedProduct.originalPrice" class="original-price">
                  {{ relatedProduct.originalPrice | number }}‚Ç´
                </span>
              </div>
              <div class="product-rating">
                <span class="stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</span>
                <span class="rating">({{ relatedProduct.rating }})</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Product Not Found -->
    <div *ngIf="!isLoading && !product" class="not-found">
      <div class="not-found-icon">üòï</div>
      <h2>Kh√¥ng t√¨m th·∫•y s·∫£n ph·∫©m</h2>
      <p>S·∫£n ph·∫©m b·∫°n ƒëang t√¨m ki·∫øm kh√¥ng t·ªìn t·∫°i ho·∫∑c ƒë√£ b·ªã x√≥a.</p>
      <button class="btn btn-primary" routerLink="/products">
        üéµ Quay l·∫°i trang s·∫£n ph·∫©m
      </button>
    </div>
  </div>
</div>